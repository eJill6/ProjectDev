/*! layer弹层组件拓展类 */
!function(){layer.use("skin/layer.ext.css",function(){layer.layui_layer_extendlayerextjs=!0});var n=layer.cache||{},t=function(t){return n.skin?" "+n.skin+" "+n.skin+"-"+t:""};layer.prompt=function(n,i){n=n||{};"function"==typeof n&&(i=n);var r,u=2==n.formType?'<textarea class="layui-layer-input">'+(n.value||"")+"<\/textarea>":function(){return'<input type="'+(1==n.formType?"password":"text")+'" class="layui-layer-input" value="'+(n.value||"")+'">'}();return layer.open($.extend({btn:["&#x786E;&#x5B9A;","&#x53D6;&#x6D88;"],content:u,skin:"layui-layer-prompt"+t("prompt"),success:function(n){r=n.find(".layui-layer-input");r.focus()},yes:function(t){var u=r.val();""===u?r.focus():u.length>(n.maxlength||500)?layer.tips("&#x6700;&#x591A;&#x8F93;&#x5165;"+(n.maxlength||500)+"&#x4E2A;&#x5B57;&#x6570;",r,{tips:1}):i&&i(u,t,r)}},n))};layer.tab=function(n){n=n||{};var i=n.tab||{};return layer.open($.extend({type:1,skin:"layui-layer-tab"+t("tab"),title:function(){var r=i.length,n=1,t="";if(r>0)for(t='<span class="layui-layer-tabnow">'+i[0].title+"<\/span>";r>n;n++)t+="<span>"+i[n].title+"<\/span>";return t}(),content:'<ul class="layui-layer-tabmain">'+function(){var r=i.length,n=1,t="";if(r>0)for(t='<li class="layui-layer-tabli xubox_tab_layer">'+(i[0].content||"no content")+"<\/li>";r>n;n++)t+='<li class="layui-layer-tabli">'+(i[n].content||"no  content")+"<\/li>";return t}()+"<\/ul>",success:function(n){var t=n.find(".layui-layer-title").children(),i=n.find(".layui-layer-tabmain").children();t.on("mousedown",function(n){n.stopPropagation?n.stopPropagation():n.cancelBubble=!0;var t=$(this),r=t.index();t.addClass("layui-layer-tabnow").siblings().removeClass("layui-layer-tabnow");i.eq(r).show().siblings().hide()})}},n))};layer.photos=function(n,i,r){function l(n,t,i){var r=new Image;r.onload=function(){r.onload=null;t(r)};r.onerror=function(n){r.onerror=null;i(n)};r.src=n}var u={},s,c;if(n=n||{},n.photos){var h=n.photos.constructor===Object,o=h?n.photos:{},f=o.data||[],e=o.start||0;if(u.imgIndex=e+1,h){if(0===f.length)return void layer.msg("&#x6CA1;&#x6709;&#x56FE;&#x7247;")}else{if(s=$(n.photos),c=s.find(n.img||"img"),0===c.length)return;if(i||s.find(o.img||"img").each(function(t){var i=$(this);f.push({alt:i.attr("alt"),pid:i.attr("layer-pid"),src:i.attr("layer-src")||i.attr("src"),thumb:i.attr("src")});i.on("click",function(){layer.photos($.extend(n,{photos:{start:t,data:f,tab:n.tab},full:n.full}),!0)})}),!i)return}u.imgprev=function(n){u.imgIndex--;u.imgIndex<1&&(u.imgIndex=f.length);u.tabimg(n)};u.imgnext=function(n,t){u.imgIndex++;u.imgIndex>f.length&&(u.imgIndex=1,t)||u.tabimg(n)};u.keyup=function(n){if(!u.end){var t=n.keyCode;n.preventDefault();37===t?u.imgprev(!0):39===t?u.imgnext(!0):27===t&&layer.close(u.index)}};u.tabimg=function(t){f.length<=1||(o.start=u.imgIndex-1,layer.close(u.index),layer.photos(n,!0,t))};u.event=function(){u.bigimg.hover(function(){u.imgsee.show()},function(){u.imgsee.hide()});u.bigimg.find(".layui-layer-imgprev").on("click",function(n){n.preventDefault();u.imgprev()});u.bigimg.find(".layui-layer-imgnext").on("click",function(n){n.preventDefault();u.imgnext()});$(document).on("keyup",u.keyup)};u.loadi=layer.load(1,{shade:"shade"in n?!1:.9,scrollbar:!1});l(f[e].src,function(i){layer.close(u.loadi);u.index=layer.open($.extend({type:1,area:function(){var t=[i.width,i.height],r=[$(window).width()-100,$(window).height()-100];return!n.full&&t[0]>r[0]&&(t[0]=r[0],t[1]=t[0]*r[1]/t[0]),[t[0]+"px",t[1]+"px"]}(),title:!1,shade:.9,shadeClose:!0,closeBtn:!1,move:".layui-layer-phimg img",moveType:1,scrollbar:!1,moveOut:!0,shift:5*Math.random()|0,skin:"layui-layer-photos"+t("photos"),content:'<div class="layui-layer-phimg"><img src="'+f[e].src+'" alt="'+(f[e].alt||"")+'" layer-pid="'+f[e].pid+'"><div class="layui-layer-imgsee">'+(f.length>1?'<span class="layui-layer-imguide"><a href="javascript:;" class="layui-layer-iconext layui-layer-imgprev"><\/a><a href="javascript:;" class="layui-layer-iconext layui-layer-imgnext"><\/a><\/span>':"")+'<div class="layui-layer-imgbar" style="display:'+(r?"block":"")+'"><span class="layui-layer-imgtit"><a href="javascript:;">'+(f[e].alt||"")+"<\/a><em>"+u.imgIndex+"/"+f.length+"<\/em><\/span><\/div><\/div><\/div>",success:function(t){u.bigimg=t.find(".layui-layer-phimg");u.imgsee=t.find(".layui-layer-imguide,.layui-layer-imgbar");u.event(t);n.tab&&n.tab(f[e],t)},end:function(){u.end=!0;$(document).off("keyup",u.keyup)}},n))},function(){layer.close(u.loadi);layer.msg("&#x5F53;&#x524D;&#x56FE;&#x7247;&#x5730;&#x5740;&#x5F02;&#x5E38;<br>&#x662F;&#x5426;&#x7EE7;&#x7EED;&#x67E5;&#x770B;&#x4E0B;&#x4E00;&#x5F20;&#xFF1F;",{time:3e4,btn:["下一张","不看了"],yes:function(){f.length>1&&u.imgnext(!0,!0)}})})}}}();